{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 70929a99207900c3a94f","webpack:///./src/el.js","webpack:///./src/index.js"],"names":["el","tagName","attributes","children","Error","element","document","createElement","Object","keys","forEach","i","test","toLowerCase","setAttribute","innerHTML","Array","child","appendChild","TypoReporter","props","rootNode","formId","snippetFieldName","urlFieldName","commentFieldName","endpointUrl","offset","translations","locale","i18n","node","state","submit","bind","handleCommentChange","closeDialog","addEventListener","event","ctrlKey","which","showDialog","refresh","prototype","en","header","messageLabel","commentLabel","send","sending","cancel","error","ru","render","isOpen","class","snippet","replace","onKeyup","comment","style","type","onClick","isSending","isError","nodeTree","data","window","location","href","fetch","method","headers","body","JSON","stringify","then","response","json","catch","console","err","getSnippet","selection","getSelection","selectionText","toString","range","getRangeAt","preRange","createRange","postRange","setStartBefore","startContainer","ownerDocument","setEnd","startOffset","setStart","endContainer","endOffset","setEndAfter","pre","substr","post","result","sanitize","innerText","target","value"],"mappings":"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","file":"TypoReporter.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"TypoReporter\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"TypoReporter\"] = factory();\n\telse\n\t\troot[\"TypoReporter\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 70929a99207900c3a94f","/*\n * Helper function to create a DOM elements\n *\n * @param string tagName\n * @param object attributes. Set tag attributes or event handlers.\n * Event handlers start with `on` and are written in upperCamelCase, e.g. `onClick`\n * @param array||string children. Either a string that is parsed as HTML or an array of DOM nodes\n * @return Element. Rendered Element object\n */\nexport default function el(tagName, attributes, children) {\n\tif (typeof tagName !== 'string') {\n\t\tthrow new Error('tagName must be a string');\n\t}\n\n\tvar element = document.createElement(tagName);\n\n\tif (attributes && typeof attributes === 'object') {\n\t\tObject.keys(attributes).forEach(function (i) {\n\t\t\t// Set event handlers\n\t\t\tif (/on[A-Z][a-z]/.test(i)) {\n\t\t\t\telement[i.toLowerCase()] = attributes[i];\n\t\t\t} else {\n\t\t\t\t// Set attributes\n\t\t\t\telement.setAttribute(i, attributes[i]);\n\t\t\t}\n\t\t});\n\t}\n\n\tif (typeof children === 'string') {\n\t\telement.innerHTML = children;\n\t} else if (children instanceof Array) {\n\t\tchildren.forEach(function (child) {\n\t\t\telement.appendChild(child);\n\t\t});\n\t}\n\n\treturn element;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/el.js","import el from './el.js';\n\n/*\n * TypoReporter.\n * @param object props. Object of options.\n * @param Element\n */\nfunction TypoReporter(props, rootNode) {\n\tprops = props || {};\n\tif (!rootNode) {\n\t\tthrow new Error('\"rootNode\" is not passed');\n\t}\n\tif (!props.formId) {\n\t\tthrow new Error('\"formId\" option is not defined');\n\t}\n\tprops.snippetFieldName = props.snippetFieldName || 'entry.13240190';\n\tprops.urlFieldName = props.urlFieldName || 'entry.238687347';\n\tprops.commentFieldName = props.commentFieldName || 'entry.1447231081';\n\tprops.endpointUrl = props.endpointUrl ||\n\t\t'https://cors-anywhere.herokuapp.com/https://docs.google.com/forms/d/e/' +\n\t\tprops.formId + '/formResponse?embedded=true';\n\tprops.offset = props.offset || 50;\n\tprops.translations = props.translations || this.translations;\n\tprops.locale = props.locale || 'en';\n\tif (!props.translations[props.locale]) {\n\t\tthrow new Error('No translations defined for locale ' + props.locale);\n\t}\n\tthis.i18n = props.translations[props.locale];\n\tthis.props = props;\n\tthis.node = rootNode;\n\tthis.state = {};\n\n\t// Bind methods\n\tthis.submit = this.submit.bind(this);\n\tthis.handleCommentChange = this.handleCommentChange.bind(this);\n\tthis.closeDialog = this.closeDialog.bind(this);\n\n\t// Setup key bindings\n\tdocument.addEventListener('keydown', function (event) {\n\t\tif (event.ctrlKey && event.which === 13) {\n\t\t\tthis.showDialog();\n\t\t}\n\t\tif (event.which === 27) {\n\t\t\tthis.closeDialog();\n\t\t}\n\t}.bind(this));\n\n\tthis.refresh();\n}\n\nTypoReporter.prototype.translations = {\n\ten: {\n\t\theader: 'Report a mistake on the page',\n\t\tmessageLabel: 'There is a mistake in the following text:',\n\t\tcommentLabel: '<strong>Do you want to send a notice to a webmaster?</strong>',\n\t\tsend: '<strong>Send</strong>',\n\t\tsending: 'Sending',\n\t\tcancel: 'Cancel',\n\t\terror: 'Error! Something went wrong...'\n\t},\n\tru: {\n\t\theader: 'Сообщите об ошибке на странице',\n\t\tmessageLabel: 'Ошибка содержится в следующем тексте:',\n\t\tcommentLabel: '<strong>Отправить сообщение об ошибке редактору сайта?</strong>',\n\t\tsend: '<strong>Отправить</strong>',\n\t\tsending: 'Отправляю',\n\t\tcancel: 'Отмена',\n\t\terror: 'Ошибка! Что-то пошло не так...'\n\t}\n};\n\nTypoReporter.prototype.render = function () {\n\tvar state = this.state;\n\tvar i18n = this.i18n;\n\n\treturn state.isOpen && el('div', {class: 'ReportTypo'}, [\n\t\tel('div', {class: 'ReportTypo-header'}, i18n.header),\n\t\tel('div', {class: 'ReportTypo-label'}, i18n.messageLabel),\n\t\tel('div', {class: 'ReportTypo-message'}, state.snippet.replace('>>>', '<u class=\"ReportTypo-heighlight\">').replace('<<<', '</u>')),\n\t\tel('div', {class: 'ReportTypo-comment-container'}, [\n\t\t\tel('textarea', {class: 'ReportTypo-comment', onKeyup: this.handleCommentChange}, state.comment)\n\t\t]),\n\t\tel('div', {class: 'ReportTypo-label'}, i18n.commentLabel),\n\t\tel('div', {style: 'text-align: right;'}, [\n\t\t\tel('button', {type: 'button', class: 'ReportTypo-submit', onClick: this.submit}, state.isSending ? i18n.sending : i18n.send),\n\t\t\tel('button', {type: 'button', class: 'ReportTypo-cancel', onClick: this.closeDialog}, i18n.cancel)\n\t\t]),\n\t\tel('div', null, state.isError && i18n.error)\n\t]);\n};\n\nTypoReporter.prototype.refresh = function () {\n\tvar node = this.node;\n\tnode.innerHTML = '';\n\tvar nodeTree = this.render();\n\tif (nodeTree) {\n\t\tnode.appendChild(nodeTree);\n\t}\n};\n\nTypoReporter.prototype.submit =\tfunction () {\n\tvar state = this.state;\n\tvar props = this.props;\n\n\tstate.isSending = true;\n\tthis.refresh();\n\n\tvar data = {\n\t\tdata: {\n\t\t\t[props.snippetFieldName]: state.snippet,\n\t\t\t[props.commentFieldName]: state.comment,\n\t\t\t[props.urlFieldName]: window.location.href,\n\t\t\t'language': props.locale\n\t\t}\n\t};\n\n\tfetch(props.endpointUrl, {\n\t\tmethod: 'POST',\n\t\theaders: {\n\t\t\t'Content-Type': 'application/json'\n\t\t},\n\t\tbody: JSON.stringify(data)\n\t})\n\t.then(response => response.json())\n\t.then(() => {\n\t\tthis.closeDialog();\n\t})\n\t.catch(err => {\n\t\tconsole.error(err);\n\t\tstate.isError = true;\n\t\tstate.isSending = false;\n\t\tthis.refresh();\n\t});\n};\n\nTypoReporter.prototype.getSnippet = function () {\n\tvar props = this.props;\n\n\tvar selection = document.getSelection();\n\tvar selectionText = selection.toString();\n\tif (selectionText) {\n\t\tvar range = selection.getRangeAt(0);\n\t\tvar preRange = document.createRange();\n\t\tvar postRange = document.createRange();\n\t\tpreRange.setStartBefore(range.startContainer.ownerDocument.body);\n\t\tpreRange.setEnd(range.startContainer, range.startOffset);\n\t\tpostRange.setStart(range.endContainer, range.endOffset);\n\t\tpostRange.setEndAfter(range.endContainer.ownerDocument.body);\n\t\tvar pre = preRange.toString().substr(-props.offset);\n\t\tvar post = postRange.toString().substr(0, props.offset);\n\t\tvar result = pre + '>>>' + selectionText + '<<<' + post;\n\t\tvar sanitize = document.createElement('div');\n\t\tsanitize.innerHTML = result;\n\t\treturn sanitize.innerText.replace(/\\r?\\n|\\r/g, '').replace(/\\s+/g, ' ');\n\t}\n};\n\nTypoReporter.prototype.showDialog = function () {\n\tvar state = this.state;\n\n\tstate.snippet = this.getSnippet();\n\tif (state.snippet) {\n\t\tstate.isOpen = true;\n\t\tthis.refresh();\n\t}\n};\n\nTypoReporter.prototype.closeDialog = function () {\n\t// Completely reset the state\n\tthis.state = {};\n\tthis.refresh();\n};\n\nTypoReporter.prototype.handleCommentChange = function (event) {\n\tthis.state.comment = event.target.value;\n};\n\nexport default TypoReporter;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}